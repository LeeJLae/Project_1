from ultralytics import YOLO
import os

# YOLO 모델 로드 (기존 가중치 사용)
model = YOLO('/home/jovyan/data-vol-1/Result/2_Measure/YOLO/BB_weight/2Step_yolov11m/2Step_2nd.pt')  # 사전 학습된 가중치 파일 경로

# 증강된 데이터셋 경로를 정의한 .yaml 파일 경로
train_data = '/home/jovyan/data-vol-1/Y_T_Data/YOLO_WB.yaml'  # 증강된 데이터셋의 yaml 파일 경로

# 학습 결과를 저장할 디렉토리 생성
output_dir = '/home/jovyan/data-vol-1/Result/2_Measure/YOLO/WB'
os.makedirs(output_dir, exist_ok=True)

# YOLO 학습 실행
model.train(
    data=train_data,
    epochs=1,               # 에포크 수 지정
    imgsz=640,
    batch=16,
    lr0=0.001,               # 초기 학습률 설정왜 O
    device='cuda',
    amp=False,
    val=False
)

# 학습된 모델 저장Eh
model.save(os.path.join(output_dir, 'YOLO_WB.pt'))
